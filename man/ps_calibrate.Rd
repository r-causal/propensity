% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ps_calibration.R
\name{ps_calibrate}
\alias{ps_calibrate}
\title{Calibrate propensity scores}
\usage{
ps_calibrate(
  ps,
  .exposure,
  method = c("logistic", "isoreg"),
  smooth = TRUE,
  .focal_level = NULL,
  .reference_level = NULL,
  estimand = NULL,
  .treated = NULL,
  .untreated = NULL
)
}
\arguments{
\item{ps}{Numeric vector of propensity scores between 0 and 1}

\item{.exposure}{A binary vector of treatment assignments}

\item{method}{Calibration method:
\describe{
\item{\code{"logistic"}}{(Default) Logistic calibration (also known as Platt scaling).
Assumes a sigmoid relationship between observed and true probabilities.
Best when: propensity scores follow a logistic pattern but are
systematically biased. Provides smooth, parametric calibration.
Faster and more stable with small samples.}
\item{\code{"isoreg"}}{Isotonic regression calibration. Uses a non-parametric
monotonic transformation. Best when: the relationship between observed
and true probabilities is non-linear or when you want to preserve
the rank order without assuming a specific functional form.
More flexible but requires larger samples for stable estimates.}
}}

\item{smooth}{Logical. For \code{method = "logistic"}, whether to use a smoothed
logistic spline model (\code{smooth = TRUE}, default) or simple logistic
regression (\code{smooth = FALSE}). When \code{TRUE}, uses \code{mgcv::gam()} with
spline smoothing. When \code{FALSE}, uses \code{stats::glm()}. Ignored for
\code{method = "isoreg"}.}

\item{.focal_level}{The value representing the focal group (typically treatment).
If not provided, \code{ps_calibrate()} will attempt to automatically determine the coding.}

\item{.reference_level}{The value representing the reference group (typically control).
If not provided, \code{ps_calibrate()} will attempt to automatically determine the coding.}

\item{estimand}{Character indicating the estimand type.}

\item{.treated}{\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#deprecated}{\figure{lifecycle-deprecated.svg}{options: alt='[Deprecated]'}}}{\strong{[Deprecated]}} Use \code{.focal_level} instead.}

\item{.untreated}{\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#deprecated}{\figure{lifecycle-deprecated.svg}{options: alt='[Deprecated]'}}}{\strong{[Deprecated]}} Use \code{.reference_level} instead.}
}
\value{
A calibrated propensity score object (\code{psw})
}
\description{
This function calibrates propensity scores to improve their accuracy using
either Platt scaling (logistic regression) or isotonic regression. It
preserves the attributes of causal weight objects when applicable.
}
\examples{
# Generate example data
ps <- runif(100)
exposure <- rbinom(100, 1, ps)

# Logistic calibration with smoothing (default)
calibrated_smooth <- ps_calibrate(ps, exposure)

# Logistic calibration without smoothing (simple logistic regression)
calibrated_simple <- ps_calibrate(ps, exposure, smooth = FALSE)

# Isotonic regression
calibrated_iso <- ps_calibrate(ps, exposure, method = "isoreg")
}
