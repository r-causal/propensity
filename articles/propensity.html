<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with propensity • propensity</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with propensity">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">propensity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/propensity.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-causal/propensity/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting Started with propensity</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-causal/propensity/blob/main/vignettes/propensity.Rmd" class="external-link"><code>vignettes/propensity.Rmd</code></a></small>
      <div class="d-none name"><code>propensity.Rmd</code></div>
    </div>

    
    
<p>This vignette walks through the core propensity score weighting
workflow: fitting a propensity score model, calculating weights, and
estimating causal effects with <code><a href="../reference/ipw.html">ipw()</a></code>. We’ll also cover what
to do when propensity scores are extreme.</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-causal.github.io/propensity/">propensity</a></span><span class="op">)</span></span></code></pre></div>
<p>We’ll work with a simulated dataset throughout. There are two
confounders (<code>x1</code> and <code>x2</code>), a binary exposure
(<code>z</code>), and a binary outcome (<code>y</code>):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">z</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">z</span>, <span class="va">y</span>, <span class="va">x2</span><span class="op">)</span></span></code></pre></div>
<p>Both <code>x1</code> and <code>x2</code> affect treatment and
outcome, so we need to adjust for them.</p>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<div class="section level3">
<h3 id="step-1-fit-a-propensity-score-model">Step 1: Fit a propensity score model<a class="anchor" aria-label="anchor" href="#step-1-fit-a-propensity-score-model"></a>
</h3>
<p>Start with a model for treatment assignment. Here we use logistic
regression:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-calculate-weights-and-fit-a-weighted-outcome-model">Step 2: Calculate weights and fit a weighted outcome model<a class="anchor" aria-label="anchor" href="#step-2-calculate-weights-and-fit-a-weighted-outcome-model"></a>
</h3>
<p>Pass the fitted model directly to <code><a href="../reference/wt_ate.html">wt_ate()</a></code> to get ATE
weights. It pulls out the fitted values and exposure for you:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using exposure variable <span style="color: #0000BB;">"z"</span> from GLM model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="va">outcome_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span>, weights <span class="op">=</span> <span class="va">wts</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial glm!</span></span></code></pre></div>
<p><code><a href="../reference/wt_ate.html">wt_ate()</a></code> returns a <code>psw</code> object, which is
just a numeric vector with some extra metadata attached:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/psw.html">estimand</a></span><span class="op">(</span><span class="va">wts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ate"</span></span>
<span><span class="fu"><a href="../reference/psw.html">is_stabilized</a></span><span class="op">(</span><span class="va">wts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>You can also pass propensity scores as a plain numeric vector. In
that case you need to supply the exposure too:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html" class="external-link">fitted</a></span><span class="op">(</span><span class="va">ps_mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps</span>, <span class="va">dat</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="co">#&gt; &lt;psw{estimand = ate}[100]&gt;</span></span>
<span><span class="co">#&gt;   [1]  1.237569  1.962759  2.211732  1.312977  1.974772  1.918957  3.413991</span></span>
<span><span class="co">#&gt;   [8]  1.844849  1.223426  2.048453  1.409967  1.189795  1.283684  2.580633</span></span>
<span><span class="co">#&gt;  [15]  1.439961  1.771951  1.627989  3.438494  1.092310  1.379591  1.414973</span></span>
<span><span class="co">#&gt;  [22]  1.142879  2.132832  2.539924  1.264028  1.584122  1.614753  1.115628</span></span>
<span><span class="co">#&gt;  [29]  2.235160  1.641530  1.598952  1.767794  1.494051  2.039262  3.465881</span></span>
<span><span class="co">#&gt;  [36]  1.174226  1.511863  1.832668  1.135144  2.045876  2.067593  2.960898</span></span>
<span><span class="co">#&gt;  [43]  1.724205  2.807457  1.296458  1.487979  1.433057  3.287998  2.085343</span></span>
<span><span class="co">#&gt;  [50]  2.000254  1.845028  1.286187  1.207434  2.360698  1.840088  1.704295</span></span>
<span><span class="co">#&gt;  [57]  1.642486  2.362152 12.582758  2.974447  1.677742  1.704949  2.553764</span></span>
<span><span class="co">#&gt;  [64]  1.438721  1.711034  1.227343  1.812465  1.409825  1.518867  3.314572</span></span>
<span><span class="co">#&gt;  [71]  1.404951  1.799540  2.354036  1.941761  1.909359  1.731474  2.080547</span></span>
<span><span class="co">#&gt;  [78]  2.731912  1.606549  3.350612  1.327948  2.103802  2.178471  2.018730</span></span>
<span><span class="co">#&gt;  [85]  3.813295  1.864473  2.078958  1.959235  1.747083  1.907159  3.853789</span></span>
<span><span class="co">#&gt;  [92]  1.584359  2.693732  1.644175  1.286716  1.788770  3.037240  1.416308</span></span>
<span><span class="co">#&gt;  [99]  1.474800  1.619529</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-estimate-causal-effects">Step 3: Estimate causal effects<a class="anchor" aria-label="anchor" href="#step-3-estimate-causal-effects"></a>
</h3>
<p><code><a href="../reference/ipw.html">ipw()</a></code> takes the propensity score model and the weighted
outcome model and returns causal effect estimates. The standard errors
use linearization to account for the fact that the propensity scores are
estimated:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ipw.html">ipw</a></span><span class="op">(</span><span class="va">ps_mod</span>, <span class="va">outcome_mod</span><span class="op">)</span></span>
<span><span class="va">result</span></span>
<span><span class="co">#&gt; Inverse Probability Weight Estimator</span></span>
<span><span class="co">#&gt; Estimand: ATE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Propensity Score Model:</span></span>
<span><span class="co">#&gt;   Call: glm(formula = z ~ x1 + x2, family = binomial(), data = dat) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Outcome Model:</span></span>
<span><span class="co">#&gt;   Call: glm(formula = y ~ z, family = binomial(), data = dat, weights = wts) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimates:</span></span>
<span><span class="co">#&gt;         estimate  std.err        z ci.lower ci.upper conf.level   p.value    </span></span>
<span><span class="co">#&gt; rd       0.32000  0.10411  3.07376   0.1160  0.52404       0.95  0.002114 ** </span></span>
<span><span class="co">#&gt; log(rr)  0.69137  0.12490  5.53528   0.4466  0.93618       0.95 3.107e-08 ***</span></span>
<span><span class="co">#&gt; log(or)  1.32884  0.12288 10.81398   1.0880  1.56969       0.95 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="choosing-an-estimand">Choosing an estimand<a class="anchor" aria-label="anchor" href="#choosing-an-estimand"></a>
</h2>
<p>Each estimand targets a different population:</p>
<table class="table">
<thead><tr class="header">
<th>Estimand</th>
<th>Target population</th>
<th>Function</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>ATE</td>
<td>Entire study population</td>
<td><code><a href="../reference/wt_ate.html">wt_ate()</a></code></td>
</tr>
<tr class="even">
<td>ATT</td>
<td>Treated (focal) group</td>
<td><code><a href="../reference/wt_ate.html">wt_att()</a></code></td>
</tr>
<tr class="odd">
<td>ATU</td>
<td>Untreated (reference) group</td>
<td><code><a href="../reference/wt_ate.html">wt_atu()</a></code></td>
</tr>
<tr class="even">
<td>ATO</td>
<td>Overlap population</td>
<td><code><a href="../reference/wt_ate.html">wt_ato()</a></code></td>
</tr>
<tr class="odd">
<td>ATM</td>
<td>Matched population</td>
<td><code><a href="../reference/wt_ate.html">wt_atm()</a></code></td>
</tr>
<tr class="even">
<td>Entropy</td>
<td>Entropy-balanced population</td>
<td><code><a href="../reference/wt_ate.html">wt_entropy()</a></code></td>
</tr>
</tbody>
</table>
<p><code><a href="../reference/wt_ate.html">wt_atc()</a></code> is an alias for <code><a href="../reference/wt_ate.html">wt_atu()</a></code>.</p>
<p>ATE is the most common choice. ATT and ATU narrow the question to the
treated or untreated, respectively. ATO, ATM, and entropy weights target
overlap populations – they produce bounded weights by construction,
which makes them a good option when propensity scores are extreme (more
on that below).</p>
<p>To switch estimands, just swap the weight function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wts_ate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using exposure variable <span style="color: #0000BB;">"z"</span> from GLM model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="va">wts_att</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_att</a></span><span class="op">(</span><span class="va">ps_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using exposure variable <span style="color: #0000BB;">"z"</span> from GLM model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="va">wts_ato</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_ato</a></span><span class="op">(</span><span class="va">ps_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using exposure variable <span style="color: #0000BB;">"z"</span> from GLM model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="handling-extreme-weights">Handling extreme weights<a class="anchor" aria-label="anchor" href="#handling-extreme-weights"></a>
</h2>
<p>Propensity scores near 0 or 1 produce large weights that can blow up
your variance. The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method gives a quick look at
the weight distribution:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wts_ate</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   1.092   1.440   1.780   2.028   2.111  12.583</span></span></code></pre></div>
<p>If you see a very large maximum or high variance, you have a few
options.</p>
<div class="section level3">
<h3 id="overlap-estimands">Overlap estimands<a class="anchor" aria-label="anchor" href="#overlap-estimands"></a>
</h3>
<p>The easiest fix is to use an estimand with bounded weights.
<code><a href="../reference/wt_ate.html">wt_ato()</a></code> and <code><a href="../reference/wt_ate.html">wt_atm()</a></code> down-weight observations
where overlap is poor:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/wt_ate.html">wt_ato</a></span><span class="op">(</span><span class="va">ps_mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using exposure variable <span style="color: #0000BB;">"z"</span> from GLM model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.08451 0.30539 0.43830 0.43370 0.52629 0.92053</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/wt_ate.html">wt_atm</a></span><span class="op">(</span><span class="va">ps_mod</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using exposure variable <span style="color: #0000BB;">"z"</span> from GLM model</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.09231 0.43965 0.78036 0.70946 1.00000 1.00000</span></span></code></pre></div>
<p>The trade-off is that you’re now targeting a different
population.</p>
</div>
<div class="section level3">
<h3 id="trimming">Trimming<a class="anchor" aria-label="anchor" href="#trimming"></a>
</h3>
<p><code><a href="../reference/ps_trim.html">ps_trim()</a></code> drops observations with extreme propensity
scores by setting them to <code>NA</code>. The <code>"ps"</code> method
uses fixed thresholds (by default, 0.1 and 0.9):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_trimmed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ps_trim.html">ps_trim</a></span><span class="op">(</span><span class="va">ps</span>, method <span class="op">=</span> <span class="st">"ps"</span><span class="op">)</span></span></code></pre></div>
<p>The <code>"adaptive"</code> method (Crump et al., 2009) finds a
data-driven threshold:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_trimmed_adapt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ps_trim.html">ps_trim</a></span><span class="op">(</span><span class="va">ps</span>, method <span class="op">=</span> <span class="st">"adaptive"</span><span class="op">)</span></span></code></pre></div>
<p>You can inspect the result with a few helpers:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Confirm the object has been trimmed</span></span>
<span><span class="fu"><a href="../reference/is_ps_trimmed.html">is_ps_trimmed</a></span><span class="op">(</span><span class="va">ps_trimmed</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="co"># Which observations were removed?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/is_unit_trimmed.html">is_unit_trimmed</a></span><span class="op">(</span><span class="va">ps_trimmed</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span></span>
<span><span class="co"># View trimming metadata (method, cutoffs, etc.)</span></span>
<span><span class="fu"><a href="../reference/ps_trim_meta.html">ps_trim_meta</a></span><span class="op">(</span><span class="va">ps_trimmed</span><span class="op">)</span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ps"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower</span></span>
<span><span class="co">#&gt; [1] 0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper</span></span>
<span><span class="co">#&gt; [1] 0.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $keep_idx</span></span>
<span><span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  20  21 </span></span>
<span><span class="co">#&gt;   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  20  21 </span></span>
<span><span class="co">#&gt;  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41 </span></span>
<span><span class="co">#&gt;  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41 </span></span>
<span><span class="co">#&gt;  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  60  61  62 </span></span>
<span><span class="co">#&gt;  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  60  61  62 </span></span>
<span><span class="co">#&gt;  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82 </span></span>
<span><span class="co">#&gt;  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82 </span></span>
<span><span class="co">#&gt;  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 </span></span>
<span><span class="co">#&gt;  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $trimmed_idx</span></span>
<span><span class="co">#&gt; [1] 19 59</span></span></code></pre></div>
<p>Use <code>!is_unit_trimmed()</code> to subset your data down to the
retained observations:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">retained</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="../reference/is_unit_trimmed.html">is_unit_trimmed</a></span><span class="op">(</span><span class="va">ps_trimmed</span><span class="op">)</span></span>
<span><span class="va">dat_trimmed</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span><span class="va">retained</span>, <span class="op">]</span></span></code></pre></div>
<p>After trimming, you should refit the propensity score model on the
retained sample so the scores reflect the trimmed population:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_refitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ps_refit.html">ps_refit</a></span><span class="op">(</span><span class="va">ps_trimmed</span>, <span class="va">ps_mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_refit.html">is_refit</a></span><span class="op">(</span><span class="va">ps_refitted</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Then pass the refitted scores to the weight function as usual:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wts_trimmed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps_refitted</span>, <span class="va">dat</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wts_trimmed</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's </span></span>
<span><span class="co">#&gt;   1.073   1.386   1.726   1.970   2.157   4.724       2</span></span></code></pre></div>
<p>See <code><a href="../reference/ps_trim.html">?ps_trim</a></code> for other trimming methods, including
percentile-based (<code>"pctl"</code>), preference score
(<code>"pref"</code>), and common range (<code>"cr"</code>).</p>
</div>
<div class="section level3">
<h3 id="truncation">Truncation<a class="anchor" aria-label="anchor" href="#truncation"></a>
</h3>
<p>Truncation is similar to trimming but keeps all observations – it
just clips extreme scores to specified bounds:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_truncated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ps_trunc.html">ps_trunc</a></span><span class="op">(</span><span class="va">ps</span>, lower <span class="op">=</span> <span class="fl">0.05</span>, upper <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/is_unit_truncated.html">is_unit_truncated()</a></code> tells you which observations were
clipped:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is_ps_truncated.html">is_ps_truncated</a></span><span class="op">(</span><span class="va">ps_truncated</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="../reference/is_unit_truncated.html">is_unit_truncated</a></span><span class="op">(</span><span class="va">ps_truncated</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="../reference/ps_trunc_meta.html">ps_trunc_meta</a></span><span class="op">(</span><span class="va">ps_truncated</span><span class="op">)</span></span>
<span><span class="co">#&gt; $method</span></span>
<span><span class="co">#&gt; [1] "ps"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $lower_bound</span></span>
<span><span class="co">#&gt; [1] 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $upper_bound</span></span>
<span><span class="co">#&gt; [1] 0.95</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $truncated_idx</span></span>
<span><span class="co">#&gt; integer(0)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wts_truncated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps_truncated</span>, <span class="va">dat</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">wts_truncated</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   1.092   1.440   1.780   2.028   2.111  12.583</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="which-approach">Which approach?<a class="anchor" aria-label="anchor" href="#which-approach"></a>
</h3>
<p>These aren’t mutually exclusive. In general: overlap estimands like
<code><a href="../reference/wt_ate.html">wt_ato()</a></code> are the easiest path if your research question
allows it. Trimming (followed by <code><a href="../reference/ps_refit.html">ps_refit()</a></code>) is the
standard choice when you need ATE but have near-violations of
positivity. Truncation is a lighter touch when you want to keep the full
sample.</p>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-results">Interpreting results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h2>
<div class="section level3">
<h3 id="binary-outcomes">Binary outcomes<a class="anchor" aria-label="anchor" href="#binary-outcomes"></a>
</h3>
<p>For binary outcomes, <code><a href="../reference/ipw.html">ipw()</a></code> returns three effect
measures: the risk difference, log risk ratio, and log odds ratio:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span></span>
<span><span class="co">#&gt; Inverse Probability Weight Estimator</span></span>
<span><span class="co">#&gt; Estimand: ATE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Propensity Score Model:</span></span>
<span><span class="co">#&gt;   Call: glm(formula = z ~ x1 + x2, family = binomial(), data = dat) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Outcome Model:</span></span>
<span><span class="co">#&gt;   Call: glm(formula = y ~ z, family = binomial(), data = dat, weights = wts) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimates:</span></span>
<span><span class="co">#&gt;         estimate  std.err        z ci.lower ci.upper conf.level   p.value    </span></span>
<span><span class="co">#&gt; rd       0.32000  0.10411  3.07376   0.1160  0.52404       0.95  0.002114 ** </span></span>
<span><span class="co">#&gt; log(rr)  0.69137  0.12490  5.53528   0.4466  0.93618       0.95 3.107e-08 ***</span></span>
<span><span class="co">#&gt; log(or)  1.32884  0.12288 10.81398   1.0880  1.56969       0.95 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code> pulls the estimates into a data
frame:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="co">#&gt;    effect  estimate   std.err         z  ci.lower  ci.upper conf.level</span></span>
<span><span class="co">#&gt; 1      rd 0.3199973 0.1041062  3.073758 0.1159529 0.5240417       0.95</span></span>
<span><span class="co">#&gt; 2 log(rr) 0.6913736 0.1249031  5.535278 0.4465679 0.9361792       0.95</span></span>
<span><span class="co">#&gt; 3 log(or) 1.3288426 0.1228819 10.813984 1.0879986 1.5696867       0.95</span></span>
<span><span class="co">#&gt;        p.value</span></span>
<span><span class="co">#&gt; 1 2.113806e-03</span></span>
<span><span class="co">#&gt; 2 3.107345e-08</span></span>
<span><span class="co">#&gt; 3 0.000000e+00</span></span></code></pre></div>
<p>Use <code>exponentiate = TRUE</code> to get risk ratios and odds
ratios on their natural scale. The standard errors, z-statistics, and
p-values stay on the log scale:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">result</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt;   effect  estimate   std.err         z  ci.lower  ci.upper conf.level</span></span>
<span><span class="co">#&gt; 1     rd 0.3199973 0.1041062  3.073758 0.1159529 0.5240417       0.95</span></span>
<span><span class="co">#&gt; 2     rr 1.9964559 0.1249031  5.535278 1.5629389 2.5502189       0.95</span></span>
<span><span class="co">#&gt; 3     or 3.7766698 0.1228819 10.813984 2.9683272 4.8051424       0.95</span></span>
<span><span class="co">#&gt;        p.value</span></span>
<span><span class="co">#&gt; 1 2.113806e-03</span></span>
<span><span class="co">#&gt; 2 3.107345e-08</span></span>
<span><span class="co">#&gt; 3 0.000000e+00</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="continuous-outcomes">Continuous outcomes<a class="anchor" aria-label="anchor" href="#continuous-outcomes"></a>
</h3>
<p>For continuous outcomes, <code><a href="../reference/ipw.html">ipw()</a></code> returns the mean
difference. Use <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> for the outcome model:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_cont</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">0.8</span> <span class="op">*</span> <span class="va">z</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">y_cont</span> <span class="op">&lt;-</span> <span class="va">y_cont</span></span>
<span><span class="va">outcome_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y_cont</span> <span class="op">~</span> <span class="va">z</span>, data <span class="op">=</span> <span class="va">dat</span>, weights <span class="op">=</span> <span class="va">wts</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/ipw.html">ipw</a></span><span class="op">(</span><span class="va">ps_mod</span>, <span class="va">outcome_cont</span><span class="op">)</span></span>
<span><span class="co">#&gt; Inverse Probability Weight Estimator</span></span>
<span><span class="co">#&gt; Estimand: ATE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Propensity Score Model:</span></span>
<span><span class="co">#&gt;   Call: glm(formula = z ~ x1 + x2, family = binomial(), data = dat) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Outcome Model:</span></span>
<span><span class="co">#&gt;   Call: lm(formula = y_cont ~ z, data = dat, weights = wts) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimates:</span></span>
<span><span class="co">#&gt;      estimate std.err       z ci.lower ci.upper conf.level   p.value    </span></span>
<span><span class="co">#&gt; diff  0.92737 0.20498 4.52416   0.5256   1.3291       0.95 6.064e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>The examples above all use binary exposures. propensity also handles
continuous and categorical treatments.</p>
<div class="section level3">
<h3 id="continuous-exposures">Continuous exposures<a class="anchor" aria-label="anchor" href="#continuous-exposures"></a>
</h3>
<p>For continuous exposures, weights use density ratios. Stabilization
is usually a good idea here:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit a model for the continuous exposure</span></span>
<span><span class="va">ps_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">continuous_exposure</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stabilized weights (strongly recommended for continuous exposures)</span></span>
<span><span class="va">wts_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps_cont</span>, stabilize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="categorical-exposures">Categorical exposures<a class="anchor" aria-label="anchor" href="#categorical-exposures"></a>
</h3>
<p>For multi-level treatments, pass a matrix or data frame of predicted
probabilities with one column per level:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multinomial propensity scores (one column per treatment level)</span></span>
<span><span class="va">ps_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">multinom_model</span>, type <span class="op">=</span> <span class="st">"probs"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps_matrix</span>, <span class="va">exposure</span>, exposure_type <span class="op">=</span> <span class="st">"categorical"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ATT and ATU require specifying the focal level</span></span>
<span><span class="fu"><a href="../reference/wt_ate.html">wt_att</a></span><span class="op">(</span><span class="va">ps_matrix</span>, <span class="va">exposure</span>, .focal_level <span class="op">=</span> <span class="st">"treated"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calibration">Calibration<a class="anchor" aria-label="anchor" href="#calibration"></a>
</h3>
<p><code><a href="../reference/ps_calibrate.html">ps_calibrate()</a></code> adjusts propensity scores so they better
reflect treatment probabilities. Where trimming and truncation deal with
the tails, calibration reshapes the whole distribution. It supports
logistic calibration (the default) and isotonic regression:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_calibrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ps_calibrate.html">ps_calibrate</a></span><span class="op">(</span><span class="va">ps</span>, <span class="va">dat</span><span class="op">$</span><span class="va">z</span>, method <span class="op">=</span> <span class="st">"logistic"</span>, smooth <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/is_ps_calibrated.html">is_ps_calibrated</a></span><span class="op">(</span><span class="va">ps_calibrated</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wts_calibrated</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">ps_calibrated</span>, <span class="va">dat</span><span class="op">$</span><span class="va">z</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="censoring-weights">Censoring weights<a class="anchor" aria-label="anchor" href="#censoring-weights"></a>
</h3>
<p><code><a href="../reference/wt_ate.html">wt_cens()</a></code> calculates inverse probability of censoring
weights for survival or longitudinal analyses:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model the probability of being uncensored</span></span>
<span><span class="va">cens_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">uncensored</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wts_cens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wt_ate.html">wt_cens</a></span><span class="op">(</span><span class="va">cens_mod</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Censoring weights use the same formula as ATE weights</span></span>
<span><span class="fu"><a href="../reference/psw.html">estimand</a></span><span class="op">(</span><span class="va">wts_cens</span><span class="op">)</span> <span class="co"># "uncensored"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="learning-more">Learning more<a class="anchor" aria-label="anchor" href="#learning-more"></a>
</h3>
<p>See the function reference for details:</p>
<ul>
<li>
<code><a href="../reference/wt_ate.html">?wt_ate</a></code> – Weight calculation for all estimands</li>
<li>
<code><a href="../reference/ps_trim.html">?ps_trim</a></code>, <code><a href="../reference/ps_trunc.html">?ps_trunc</a></code>,
<code><a href="../reference/ps_calibrate.html">?ps_calibrate</a></code> – Handling extreme propensity scores</li>
<li>
<code><a href="../reference/ipw.html">?ipw</a></code> – Inverse probability weighted estimation</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Malcolm Barrett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
