<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Trim Propensity Scores — ps_trim • propensity</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Trim Propensity Scores — ps_trim"><meta name="description" content="Trim observations with extreme propensity scores by replacing them with NA,
effectively removing those units from downstream analyses. The returned object
has the same length (or dimensions) as the input, with trimmed entries set to
NA. After trimming, refit the propensity score model on the retained
observations with ps_refit()."><meta property="og:description" content="Trim observations with extreme propensity scores by replacing them with NA,
effectively removing those units from downstream analyses. The returned object
has the same length (or dimensions) as the input, with trimmed entries set to
NA. After trimming, refit the propensity score model on the retained
observations with ps_refit()."><meta property="og:image" content="https://r-causal.github.io/propensity/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">propensity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/propensity.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-causal/propensity/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Trim Propensity Scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-causal/propensity/blob/main/R/ps_trim.R" class="external-link"><code>R/ps_trim.R</code></a></small>
      <div class="d-none name"><code>ps_trim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Trim observations with extreme propensity scores by replacing them with <code>NA</code>,
effectively removing those units from downstream analyses. The returned object
has the same length (or dimensions) as the input, with trimmed entries set to
<code>NA</code>. After trimming, refit the propensity score model on the retained
observations with <code><a href="ps_refit.html">ps_refit()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ps_trim</span><span class="op">(</span></span>
<span>  <span class="va">ps</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ps"</span>, <span class="st">"adaptive"</span>, <span class="st">"pctl"</span>, <span class="st">"pref"</span>, <span class="st">"cr"</span>, <span class="st">"optimal"</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .exposure <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .focal_level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .reference_level <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  .treated <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .untreated <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ps">ps<a class="anchor" aria-label="anchor" href="#arg-ps"></a></dt>
<dd><p>A numeric vector of propensity scores in (0, 1) for binary
exposures, or a matrix / data frame where each column gives the propensity
score for one level of a categorical exposure.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Trimming method. One of:</p><ul><li><p><strong><code>"ps"</code></strong> (default): Fixed threshold. Observations with propensity
scores outside <code>[lower, upper]</code> are trimmed. For categorical exposures,
observations where <em>any</em> column falls below <code>lower</code> (the symmetric
threshold delta) are trimmed.</p></li>
<li><p><strong><code>"adaptive"</code></strong>: Data-driven threshold that minimizes the asymptotic
variance of the IPW estimator (Crump et al., 2009). The <code>lower</code> and
<code>upper</code> arguments are ignored.</p></li>
<li><p><strong><code>"pctl"</code></strong>: Quantile-based. Observations outside the <code>[lower, upper]</code>
quantiles of the propensity score distribution are trimmed. Defaults:
<code>lower = 0.05</code>, <code>upper = 0.95</code>.</p></li>
<li><p><strong><code>"pref"</code></strong>: Preference score trimming. Transforms propensity scores
to the preference scale (Walker et al., 2013) and trims outside
<code>[lower, upper]</code>. Requires <code>.exposure</code>. Binary exposures only. Defaults:
<code>lower = 0.3</code>, <code>upper = 0.7</code>.</p></li>
<li><p><strong><code>"cr"</code></strong>: Common range (clinical equipoise). Trims to the overlap
region of the propensity score distributions across exposure groups.
Requires <code>.exposure</code>. Binary exposures only. The <code>lower</code> and <code>upper</code>
arguments are ignored.</p></li>
<li><p><strong><code>"optimal"</code></strong>: Multi-category optimal trimming (Yang et al., 2016).
Categorical exposures only. Requires <code>.exposure</code>.</p></li>
</ul><p>For categorical exposures, only <code>"ps"</code> and <code>"optimal"</code> are supported.</p></dd>


<dt id="arg-lower-upper">lower, upper<a class="anchor" aria-label="anchor" href="#arg-lower-upper"></a></dt>
<dd><p>Numeric thresholds whose interpretation depends on
<code>method</code>:</p><ul><li><p><code>"ps"</code>: absolute propensity score bounds (defaults: 0.1, 0.9). For
categorical exposures, only <code>lower</code> is used as the symmetric threshold.</p></li>
<li><p><code>"pctl"</code>: quantile probabilities (defaults: 0.05, 0.95).</p></li>
<li><p><code>"pref"</code>: preference score bounds (defaults: 0.3, 0.7).</p></li>
<li><p><code>"adaptive"</code>, <code>"cr"</code>, <code>"optimal"</code>: ignored (thresholds are data-driven).</p></li>
</ul></dd>


<dt id="arg--exposure">.exposure<a class="anchor" aria-label="anchor" href="#arg--exposure"></a></dt>
<dd><p>An exposure variable. Required for <code>"pref"</code>, <code>"cr"</code> (binary
vector), and <code>"optimal"</code> (factor or character). Not required for other
methods.</p></dd>


<dt id="arg--focal-level">.focal_level<a class="anchor" aria-label="anchor" href="#arg--focal-level"></a></dt>
<dd><p>The value of <code>.exposure</code> representing the focal
(treated) group. For binary exposures, defaults to the higher value.
Required for <code><a href="wt_ate.html">wt_att()</a></code> and <code><a href="wt_ate.html">wt_atu()</a></code> with categorical exposures.</p></dd>


<dt id="arg--reference-level">.reference_level<a class="anchor" aria-label="anchor" href="#arg--reference-level"></a></dt>
<dd><p>The value of <code>.exposure</code> representing the reference
(control) group. Automatically detected if not supplied.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to methods.</p></dd>


<dt id="arg--treated">.treated<a class="anchor" aria-label="anchor" href="#arg--treated"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Use <code>.focal_level</code> instead.</p></dd>


<dt id="arg--untreated">.untreated<a class="anchor" aria-label="anchor" href="#arg--untreated"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a> Use <code>.reference_level</code> instead.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <strong><code>ps_trim</code></strong> object (a numeric vector with class <code>"ps_trim"</code>, or a
matrix with class <code>"ps_trim_matrix"</code>). Trimmed observations are <code>NA</code>.
Metadata is stored in the <code>"ps_trim_meta"</code> attribute and can be accessed
with <code><a href="ps_trim_meta.html">ps_trim_meta()</a></code>. Key fields include:</p><ul><li><p><code>method</code>: the trimming method used</p></li>
<li><p><code>keep_idx</code>: integer indices of retained observations</p></li>
<li><p><code>trimmed_idx</code>: integer indices of trimmed (NA) observations</p></li>
<li><p>Method-specific fields such as <code>cutoff</code> (adaptive), <code>q_lower</code>/<code>q_upper</code>
(pctl), <code>cr_lower</code>/<code>cr_upper</code> (cr), <code>delta</code> (categorical ps),
or <code>lambda</code> (optimal)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="how-trimming-works">How trimming works<a class="anchor" aria-label="anchor" href="#how-trimming-works"></a></h3>


<p>Trimming identifies observations with extreme (near 0 or 1) propensity
scores and sets them to <code>NA</code>. These observations are excluded from
subsequent weight calculations and effect estimation. The goal is to
remove units that lack sufficient overlap between exposure groups, which
would otherwise receive extreme weights and destabilize estimates.</p>
</div>

<div class="section">
<h3 id="choosing-a-method">Choosing a method<a class="anchor" aria-label="anchor" href="#choosing-a-method"></a></h3>

<ul><li><p>Use <code>"ps"</code> when you have a specific threshold in mind or want a simple
default.</p></li>
<li><p>Use <code>"adaptive"</code> for a principled, data-driven cutoff that targets
variance reduction.</p></li>
<li><p>Use <code>"pctl"</code> to trim a fixed percentage of extreme values from each tail.</p></li>
<li><p>Use <code>"pref"</code> when you want to restrict to the region of clinical
equipoise based on the preference score.</p></li>
<li><p>Use <code>"cr"</code> to restrict to the common support region where both exposure
groups have observed propensity scores.</p></li>
<li><p>Use <code>"optimal"</code> for multi-category (3+) exposures; this is the only
data-driven method available for categorical treatments.</p></li>
</ul></div>

<div class="section">
<h3 id="typical-workflow">Typical workflow<a class="anchor" aria-label="anchor" href="#typical-workflow"></a></h3>

<ol><li><p>Fit a propensity score model</p></li>
<li><p>Apply <code>ps_trim()</code> to flag extreme values</p></li>
<li><p>Call <code><a href="ps_refit.html">ps_refit()</a></code> to re-estimate propensity scores on the retained sample</p></li>
<li><p>Compute weights with <code><a href="wt_ate.html">wt_ate()</a></code> or another weight function</p></li>
</ol></div>

<div class="section">
<h3 id="object-behavior">Object behavior<a class="anchor" aria-label="anchor" href="#object-behavior"></a></h3>


<p>Arithmetic operations on <code>ps_trim</code> objects return plain numeric vectors,
since transformed propensity scores (e.g., <code>1/ps</code>) are no longer propensity
scores. Trimmed values propagate as <code>NA</code> in calculations; use <code>na.rm = TRUE</code>
where appropriate.</p>
<p>When combining <code>ps_trim</code> objects with <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>, trimming parameters must match.
Mismatched parameters trigger a warning and return a numeric vector.</p>
<p>Use <code><a href="ps_trim_meta.html">ps_trim_meta()</a></code> to inspect the trimming metadata, including the method,
cutoffs, and which observations were retained or trimmed.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Crump, R. K., Hotz, V. J., Imbens, G. W., &amp; Mitnik, O. A. (2009). Dealing
with limited overlap in estimation of average treatment effects.
<em>Biometrika</em>, 96(1), 187–199.</p>
<p>Walker, A. M., Patrick, A. R., Lauer, M. S., et al. (2013). A tool for
assessing the feasibility of comparative effectiveness research.
<em>Comparative Effectiveness Research</em>, 3, 11–20.</p>
<p>Yang, S., Imbens, G. W., Cui, Z., Faries, D. E., &amp; Kadziola, Z. (2016).
Propensity score matching and subclassification in observational studies
with multi-level treatments. <em>Biometrics</em>, 72(4), 1055–1065.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ps_trunc.html">ps_trunc()</a></code> for bounding (winsorizing) instead of discarding,
<code><a href="ps_refit.html">ps_refit()</a></code> to re-estimate propensity scores after trimming,
<code><a href="ps_calibrate.html">ps_calibrate()</a></code> for calibration-based adjustment,
<code><a href="ps_trim_meta.html">ps_trim_meta()</a></code> to inspect trimming metadata,
<code><a href="is_ps_trimmed.html">is_ps_trimmed()</a></code> and <code><a href="is_unit_trimmed.html">is_unit_trimmed()</a></code> for logical queries.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">300</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">1.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="va">x</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fixed threshold trimming (default)</span></span></span>
<span class="r-in"><span><span class="va">trimmed</span> <span class="op">&lt;-</span> <span class="fu">ps_trim</span><span class="op">(</span><span class="va">ps</span>, method <span class="op">=</span> <span class="st">"ps"</span>, lower <span class="op">=</span> <span class="fl">0.1</span>, upper <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trimmed</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;ps_trim; trimmed 44 of [300]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         3         4         5         6         7         8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1780112 0.4934483 0.8725819 0.1353577 0.4025855 0.4752489 0.6683913 0.3506150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         9        10        11        12        13        14        15        16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA 0.3831809 0.5738044 0.7467782 0.3038553 0.1508037 0.8997256        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        17        18        19        20        21        22        23        24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7187207 0.4419184 0.7548592 0.5787647        NA 0.1244366 0.8728587        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        25        26        27        28        29        30        31        32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4313639        NA 0.5939254 0.2474276 0.6938170 0.5298266 0.6778670 0.5399668 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        33        34        35        36        37        38        39        40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7707828 0.3366773 0.2037945 0.2476600        NA 0.1768609 0.2572600 0.3484614 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        41        42        43        44        45        46        47        48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3065403        NA 0.1895191        NA 0.6415565        NA 0.3300895 0.3990495 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        49        50        51        52        53        54        55        56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3683877 0.1246121 0.1902500        NA 0.2564150 0.8160957 0.1494022        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        57        58        59        60        61        62        63        64 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3247367 0.7345271 0.7859021 0.8849770        NA        NA 0.2208817 0.4841803 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        65        66        67        68        69        70        71        72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6036086 0.1941979        NA 0.2790100 0.4585602 0.1783019 0.1731103 0.5439312 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        73        74        75        76        77        78        79        80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3822372 0.5796397 0.4114856 0.1759469 0.8218240 0.6877562 0.7649259        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        81        82        83        84        85        86        87        88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7505008        NA 0.2641422 0.1005949        NA        NA 0.2330120 0.3365148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        89        90        91        92        93        94        95        96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3055473 0.5632496 0.8745082 0.8863194 0.1269292 0.1023453        NA 0.1166039 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        97        98        99       100       101       102       103       104 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA 0.4322875 0.1893249 0.2462384 0.7703638 0.5197606 0.3273939 0.2099624 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       105       106       107       108       109       110       111       112 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1851823        NA 0.7356255        NA 0.2954896 0.3163021 0.1530042 0.3471981 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       113       114       115       116       117       118       119       120 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5921212 0.8328274 0.6227067 0.5867797 0.8065734 0.7877456 0.4663064 0.2023006 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       121       122       123       124       125       126       127       128 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8087856 0.4774812 0.8903829 0.2928150 0.1499937 0.6139848 0.2290136 0.6467536 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       129       130       131       132       133       134       135       136 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA        NA 0.6627758 0.5441083 0.7165979        NA 0.8025574 0.7998822 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       137       138       139       140       141       142       143       144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7597742 0.6921037        NA        NA 0.2509264 0.5711077 0.1970442 0.4590332 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       145       146       147       148       149       150       151       152 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6800801 0.2329425 0.6525433 0.6180388 0.1970997 0.1584870 0.7452343 0.3731672 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       153       154       155       156       157       158       159       160 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6727629 0.1889404 0.8164247 0.1043218 0.6858279 0.5895482 0.5223260 0.6558189 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       161       162       163       164       165       166       167       168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5672709 0.2368400 0.3418011 0.5540597 0.1083159 0.1806594        NA        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       169       170       171       172       173       174       175       176 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1187105 0.7490531 0.7738375 0.7077039 0.4491471 0.5416643 0.1764396 0.2333126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       177       178       179       180       181       182       183       184 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3434474 0.1704628 0.7023006        NA 0.1524604 0.1153463 0.5651259 0.1351849 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       185       186       187       188       189       190       191       192 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6161453 0.7945146 0.4382952 0.6065642 0.2328341 0.6027459 0.1139088 0.4037497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       193       194       195       196       197       198       199       200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1040353 0.3422376 0.7735701 0.6661116 0.2893391 0.2011360 0.1863223 0.2107038 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       201       202       203       204       205       206       207       208 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5327159 0.1544197        NA 0.5052145 0.1642856 0.5622725 0.3887452 0.3163883 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       209       210       211       212       213       214       215       216 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6341619 0.5095796 0.7582940 0.2665601        NA        NA 0.4774214 0.5852567 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       217       218       219       220       221       222       223       224 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8030404 0.1067663 0.1338595 0.8855459 0.5671613 0.6707177 0.2000938        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       225       226       227       228       229       230       231       232 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4538222 0.5912550 0.3993802 0.7230688 0.3094663        NA 0.8702859        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       233       234       235       236       237       238       239       240 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2415827 0.4195113        NA 0.1483657 0.2541910 0.5957602 0.4626159 0.2496911 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       241       242       243       244       245       246       247       248 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4020747        NA 0.7936546 0.6179515 0.6899355 0.2556513 0.4650462 0.5270157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       249       250       251       252       253       254       255       256 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2803714 0.2850014 0.6020472 0.3002118 0.3705819 0.3257820 0.7087374 0.5960756 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       257       258       259       260       261       262       263       264 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3306472 0.3363861 0.7464321 0.3725508 0.8297224 0.3965473 0.3250342        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       265       266       267       268       269       270       271       272 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2345937        NA        NA 0.5886632 0.6106387 0.4172303        NA 0.4137080 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       273       274       275       276       277       278       279       280 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4312953 0.1206438 0.5164038 0.8752400 0.4176263 0.7591012 0.3016993 0.4527210 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       281       282       283       284       285       286       287       288 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA 0.6501483 0.8168531 0.2393292 0.8311549 0.8851143 0.7936328 0.4317872 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       289       290       291       292       293       294       295       296 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8222307 0.3983355 0.1356224 0.6302455 0.4602807 0.3527491 0.8562989 0.3153233 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       297       298       299       300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5741435        NA 0.1008201 0.2253829 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># How many observations were trimmed?</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="is_unit_trimmed.html">is_unit_trimmed</a></span><span class="op">(</span><span class="va">trimmed</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 44</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Data-driven adaptive trimming</span></span></span>
<span class="r-in"><span><span class="fu">ps_trim</span><span class="op">(</span><span class="va">ps</span>, method <span class="op">=</span> <span class="st">"adaptive"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;ps_trim; trimmed 44 of [300]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2         3         4         5         6         7         8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1780112 0.4934483 0.8725819 0.1353577 0.4025855 0.4752489 0.6683913 0.3506150 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         9        10        11        12        13        14        15        16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA 0.3831809 0.5738044 0.7467782 0.3038553 0.1508037 0.8997256        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        17        18        19        20        21        22        23        24 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7187207 0.4419184 0.7548592 0.5787647        NA 0.1244366 0.8728587        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        25        26        27        28        29        30        31        32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4313639        NA 0.5939254 0.2474276 0.6938170 0.5298266 0.6778670 0.5399668 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        33        34        35        36        37        38        39        40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7707828 0.3366773 0.2037945 0.2476600        NA 0.1768609 0.2572600 0.3484614 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        41        42        43        44        45        46        47        48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3065403        NA 0.1895191        NA 0.6415565        NA 0.3300895 0.3990495 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        49        50        51        52        53        54        55        56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3683877 0.1246121 0.1902500        NA 0.2564150 0.8160957 0.1494022        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        57        58        59        60        61        62        63        64 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3247367 0.7345271 0.7859021 0.8849770        NA        NA 0.2208817 0.4841803 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        65        66        67        68        69        70        71        72 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6036086 0.1941979        NA 0.2790100 0.4585602 0.1783019 0.1731103 0.5439312 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        73        74        75        76        77        78        79        80 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3822372 0.5796397 0.4114856 0.1759469 0.8218240 0.6877562 0.7649259        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        81        82        83        84        85        86        87        88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7505008        NA 0.2641422 0.1005949        NA        NA 0.2330120 0.3365148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        89        90        91        92        93        94        95        96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3055473 0.5632496 0.8745082 0.8863194 0.1269292 0.1023453        NA 0.1166039 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        97        98        99       100       101       102       103       104 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA 0.4322875 0.1893249 0.2462384 0.7703638 0.5197606 0.3273939 0.2099624 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       105       106       107       108       109       110       111       112 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1851823        NA 0.7356255        NA 0.2954896 0.3163021 0.1530042 0.3471981 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       113       114       115       116       117       118       119       120 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5921212 0.8328274 0.6227067 0.5867797 0.8065734 0.7877456 0.4663064 0.2023006 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       121       122       123       124       125       126       127       128 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8087856 0.4774812 0.8903829 0.2928150 0.1499937 0.6139848 0.2290136 0.6467536 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       129       130       131       132       133       134       135       136 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA        NA 0.6627758 0.5441083 0.7165979        NA 0.8025574 0.7998822 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       137       138       139       140       141       142       143       144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7597742 0.6921037        NA        NA 0.2509264 0.5711077 0.1970442 0.4590332 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       145       146       147       148       149       150       151       152 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6800801 0.2329425 0.6525433 0.6180388 0.1970997 0.1584870 0.7452343 0.3731672 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       153       154       155       156       157       158       159       160 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6727629 0.1889404 0.8164247 0.1043218 0.6858279 0.5895482 0.5223260 0.6558189 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       161       162       163       164       165       166       167       168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5672709 0.2368400 0.3418011 0.5540597 0.1083159 0.1806594        NA        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       169       170       171       172       173       174       175       176 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1187105 0.7490531 0.7738375 0.7077039 0.4491471 0.5416643 0.1764396 0.2333126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       177       178       179       180       181       182       183       184 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3434474 0.1704628 0.7023006        NA 0.1524604 0.1153463 0.5651259 0.1351849 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       185       186       187       188       189       190       191       192 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6161453 0.7945146 0.4382952 0.6065642 0.2328341 0.6027459 0.1139088 0.4037497 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       193       194       195       196       197       198       199       200 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.1040353 0.3422376 0.7735701 0.6661116 0.2893391 0.2011360 0.1863223 0.2107038 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       201       202       203       204       205       206       207       208 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5327159 0.1544197        NA 0.5052145 0.1642856 0.5622725 0.3887452 0.3163883 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       209       210       211       212       213       214       215       216 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.6341619 0.5095796 0.7582940 0.2665601        NA        NA 0.4774214 0.5852567 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       217       218       219       220       221       222       223       224 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8030404 0.1067663 0.1338595 0.8855459 0.5671613 0.6707177 0.2000938        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       225       226       227       228       229       230       231       232 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4538222 0.5912550 0.3993802 0.7230688 0.3094663        NA 0.8702859        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       233       234       235       236       237       238       239       240 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2415827 0.4195113        NA 0.1483657 0.2541910 0.5957602 0.4626159 0.2496911 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       241       242       243       244       245       246       247       248 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4020747        NA 0.7936546 0.6179515 0.6899355 0.2556513 0.4650462 0.5270157 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       249       250       251       252       253       254       255       256 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2803714 0.2850014 0.6020472 0.3002118 0.3705819 0.3257820 0.7087374 0.5960756 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       257       258       259       260       261       262       263       264 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3306472 0.3363861 0.7464321 0.3725508 0.8297224 0.3965473 0.3250342        NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       265       266       267       268       269       270       271       272 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2345937        NA        NA 0.5886632 0.6106387 0.4172303        NA 0.4137080 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       273       274       275       276       277       278       279       280 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4312953 0.1206438 0.5164038 0.8752400 0.4176263 0.7591012 0.3016993 0.4527210 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       281       282       283       284       285       286       287       288 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NA 0.6501483 0.8168531 0.2393292 0.8311549 0.8851143 0.7936328 0.4317872 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       289       290       291       292       293       294       295       296 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8222307 0.3983355 0.1356224 0.6302455 0.4602807 0.3527491 0.8562989 0.3153233 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       297       298       299       300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5741435        NA 0.1008201 0.2253829 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quantile-based trimming at 5th and 95th percentiles</span></span></span>
<span class="r-in"><span><span class="fu">ps_trim</span><span class="op">(</span><span class="va">ps</span>, method <span class="op">=</span> <span class="st">"pctl"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;ps_trim; trimmed 30 of [300]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1          2          3          4          5          6          7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.17801124 0.49344831 0.87258189 0.13535765 0.40258554 0.47524889 0.66839132 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          8          9         10         11         12         13         14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.35061504         NA 0.38318089 0.57380442 0.74677823 0.30385529 0.15080370 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         15         16         17         18         19         20         21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.89972561         NA 0.71872070 0.44191837 0.75485924 0.57876473         NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         22         23         24         25         26         27         28 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.12443658 0.87285871         NA 0.43136394         NA 0.59392536 0.24742762 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         29         30         31         32         33         34         35 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.69381700 0.52982663 0.67786695 0.53996676 0.77078278 0.33667732 0.20379449 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         36         37         38         39         40         41         42 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.24766004         NA 0.17686094 0.25726004 0.34846140 0.30654026         NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         43         44         45         46         47         48         49 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.18951912 0.91394741 0.64155648         NA 0.33008953 0.39904946 0.36838768 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         50         51         52         53         54         55         56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.12461207 0.19024995         NA 0.25641497 0.81609573 0.14940217         NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         57         58         59         60         61         62         63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.32473671 0.73452714 0.78590206 0.88497697         NA         NA 0.22088166 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         64         65         66         67         68         69         70 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.48418025 0.60360857 0.19419787         NA 0.27900998 0.45856017 0.17830185 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         71         72         73         74         75         76         77 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.17311028 0.54393115 0.38223719 0.57963968 0.41148556 0.17594694 0.82182398 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         78         79         80         81         82         83         84 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.68775620 0.76492590 0.09594356 0.75050082 0.06658957 0.26414219 0.10059488 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         85         86         87         88         89         90         91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         NA 0.90461881 0.23301201 0.33651483 0.30554734 0.56324964 0.87450818 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         92         93         94         95         96         97         98 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.88631941 0.12692921 0.10234530 0.08426251 0.11660386         NA 0.43228752 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         99        100        101        102        103        104        105 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.18932487 0.24623842 0.77036380 0.51976065 0.32739386 0.20996243 0.18518227 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        106        107        108        109        110        111        112 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         NA 0.73562548         NA 0.29548965 0.31630208 0.15300421 0.34719807 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        113        114        115        116        117        118        119 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.59212123 0.83282741 0.62270671 0.58677974 0.80657336 0.78774559 0.46630644 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        120        121        122        123        124        125        126 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.20230064 0.80878565 0.47748117 0.89038286 0.29281504 0.14999367 0.61398482 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        127        128        129        130        131        132        133 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.22901364 0.64675362 0.06419209         NA 0.66277576 0.54410827 0.71659793 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        134        135        136        137        138        139        140 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         NA 0.80255741 0.79988215 0.75977424 0.69210372         NA 0.09079429 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        141        142        143        144        145        146        147 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25092645 0.57110768 0.19704419 0.45903320 0.68008008 0.23294255 0.65254331 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        148        149        150        151        152        153        154 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.61803876 0.19709968 0.15848705 0.74523426 0.37316715 0.67276290 0.18894043 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        155        156        157        158        159        160        161 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.81642474 0.10432180 0.68582789 0.58954824 0.52232604 0.65581895 0.56727085 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        162        163        164        165        166        167        168 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23684003 0.34180113 0.55405967 0.10831585 0.18065940         NA         NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        169        170        171        172        173        174        175 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.11871049 0.74905308 0.77383752 0.70770386 0.44914706 0.54166428 0.17643958 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        176        177        178        179        180        181        182 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.23331263 0.34344738 0.17046280 0.70230062 0.07304003 0.15246043 0.11534630 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        183        184        185        186        187        188        189 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.56512587 0.13518488 0.61614535 0.79451459 0.43829517 0.60656419 0.23283410 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        190        191        192        193        194        195        196 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.60274592 0.11390882 0.40374970 0.10403526 0.34223762 0.77357008 0.66611156 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        197        198        199        200        201        202        203 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.28933909 0.20113598 0.18632231 0.21070377 0.53271587 0.15441973         NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        204        205        206        207        208        209        210 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.50521454 0.16428559 0.56227253 0.38874517 0.31638831 0.63416193 0.50957963 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        211        212        213        214        215        216        217 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.75829404 0.26656013 0.90146489 0.09307013 0.47742144 0.58525674 0.80304044 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        218        219        220        221        222        223        224 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.10676633 0.13385955 0.88554593 0.56716130 0.67071770 0.20009381 0.91614132 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        225        226        227        228        229        230        231 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.45382217 0.59125501 0.39938022 0.72306882 0.30946625         NA 0.87028588 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        232        233        234        235        236        237        238 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         NA 0.24158271 0.41951127 0.06438704 0.14836574 0.25419100 0.59576019 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        239        240        241        242        243        244        245 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.46261588 0.24969111 0.40207472         NA 0.79365463 0.61795146 0.68993549 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        246        247        248        249        250        251        252 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25565132 0.46504618 0.52701568 0.28037136 0.28500140 0.60204716 0.30021180 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        253        254        255        256        257        258        259 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.37058188 0.32578201 0.70873738 0.59607558 0.33064721 0.33638608 0.74643214 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        260        261        262        263        264        265        266 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.37255079 0.82972242 0.39654734 0.32503416         NA 0.23459370 0.09722939 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        267        268        269        270        271        272        273 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.91692000 0.58866324 0.61063867 0.41723032         NA 0.41370803 0.43129530 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        274        275        276        277        278        279        280 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.12064385 0.51640377 0.87523995 0.41762629 0.75910122 0.30169925 0.45272098 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        281        282        283        284        285        286        287 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         NA 0.65014831 0.81685306 0.23932916 0.83115493 0.88511432 0.79363282 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        288        289        290        291        292        293        294 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.43178717 0.82223069 0.39833546 0.13562237 0.63024555 0.46028071 0.35274910 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        295        296        297        298        299        300 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.85629892 0.31532329 0.57414353         NA 0.10082012 0.22538288 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Refit after trimming, then compute weights</span></span></span>
<span class="r-in"><span><span class="va">trimmed</span> <span class="op">&lt;-</span> <span class="fu">ps_trim</span><span class="op">(</span><span class="va">ps</span>, method <span class="op">=</span> <span class="st">"adaptive"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">refitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="ps_refit.html">ps_refit</a></span><span class="op">(</span><span class="va">trimmed</span>, <span class="va">fit</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wt_ate.html">wt_ate</a></span><span class="op">(</span><span class="va">refitted</span>, .exposure <span class="op">=</span> <span class="va">z</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Treating `.exposure` as binary</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Setting focal level to <span style="color: #0000BB;">1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;psw{estimand = ate; trimmed}[300]&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] 1.240579 2.058164 1.179439 1.179070 2.479678 2.130709 1.546037 1.552398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [9]       NA 2.593380 2.268587 1.386216 1.455212 1.200838 1.140328       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [17] 3.272545 1.782675 1.371331 2.292253       NA 1.163991 1.179032       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [25] 2.328539       NA 1.731055 3.842912 1.490847 1.926820 1.525053 1.893076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [33] 3.917615 2.914998 1.280093 1.352152       NA 1.238860 1.368835 1.547658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] 1.460487       NA 4.876301       NA 2.643752       NA 2.967353 2.499634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [49] 2.687495 1.164231 1.259096       NA 3.722181 1.266295 6.029169       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [57] 3.011351 1.409295 1.316469 1.161399       NA       NA 1.307391 1.913671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [65] 1.704729 1.265160       NA 1.407989 1.832054 1.241014 1.233279 1.880192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [73] 2.599182 1.771319 1.698883 5.210593 4.889604 2.985370 1.353148       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] 1.379326       NA 1.381016 1.131873       NA       NA 1.327354 1.521848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [89] 3.180870 2.219879 1.176614 1.159464 1.167411 1.134197       NA 1.153324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [97]       NA 1.755289 1.257681 1.349711 3.911330 2.040050 2.989342 1.289839</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [105] 1.251377       NA 3.455793       NA 3.277919 1.479963 5.902359 1.544890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [113] 1.736044 1.239690 2.526861 1.750976 1.281806 1.313320 1.855984 1.277750</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121] 4.594831 1.891632 7.509198 1.433882 1.199683 2.476368 1.320718 2.678015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [129]       NA       NA 1.558717 1.879621 1.444250       NA 4.467031 1.292873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [137] 1.362404 1.494456       NA       NA 1.357789 1.796221 4.709750 1.833498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [145] 1.520225 1.327239 2.717307 1.666857 1.269646 1.211872 1.389090 1.603744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [153] 1.536293 4.889627 4.762739 1.136827 1.507810 1.743207 2.049824 2.740082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [161] 1.807638 1.333760 1.533168 2.179201 1.142162 1.244550       NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [169] 7.402829 1.381999 1.337371 1.462140 2.244100 1.887538 1.238231 1.327856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [177] 2.863148 1.229363 3.113295       NA 1.203205 1.151622 2.228379 1.178829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [185] 2.488677 1.301856 1.772273 1.696843 1.327058 1.707044 1.149680 2.473178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [193] 1.136445 1.534110 3.959981 1.551162 1.427282 1.275928 4.950895 1.291019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [201] 1.917087 1.206013       NA 2.013803 1.220295 2.215480 1.641148 1.480137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [209] 2.596564 1.997821 1.365083 1.385341       NA       NA 2.121784 1.755278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [217] 4.476669 1.140089 1.176986 1.160579 1.807966 1.540838 1.274301       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [225] 1.817720 1.738450 1.667666 1.431467 1.466275       NA 1.182816       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [233] 3.925953 2.388469       NA 1.197366 3.751310 2.377394 1.844505 1.355652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [241] 2.482541       NA 1.303304 1.667082 3.003822 3.732130 1.852048 1.936381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [249] 3.436024 1.419123 2.410589 1.448110 2.673096 1.499338 3.173717 1.725144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [257] 1.509464 2.917273 1.386860 1.602298 1.244567 1.660522 1.497792       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [265] 1.329995       NA       NA 2.341051 1.686081 1.714101       NA 1.704739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [273] 2.328877 7.296804 2.027404 1.175543 1.715160 1.363621 1.451002 1.814421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [281]       NA 1.587922 1.265073 1.337953 1.242313 1.161201 1.303341 1.753889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [289] 1.256446 2.503704 1.179438 2.572282 2.194293 1.557123 1.203649 1.477989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [297] 1.787285       NA 1.132171 1.314740</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Malcolm Barrett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

